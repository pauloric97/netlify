!function(t,i,a){"use strict";function e(t){t=tiny.extend({environment:"mobile"},t),this.shouldEmitAddEvent=t.shouldEmitAddEvent!==!1,this.environment=t.environment,this.token=t.token,this.itemId=t.itemId,this.title=t.title,this.image=t.image,this.imageForVariations=t.imageForVariations,this.text=t.text,this.quantity=t.quantity,this.item_data=t.item_data,this.meliData=t.meliData,this.GALabel=t.GALabel,this.congratsExperimentValue=t.congratsExperimentValue,this.HotjarKey=t.HotjarKey,this.validQuantity=!0;var a=t.buttonSelector||'[data-js="vip-action-cart"]';this.ui={button:i.querySelector(a),quantity:i.querySelector("#productStockQuantity"),variations:i.querySelector('[data-js="variations-input"]')},t.withVariations&&(this.withVariations=t.withVariations,this.variationsComplete=!1,this.shouldShowTooltips()&&(this.createTooltips(),this.toggleVariationsTooltip())),this.bindEvents()}e.prototype.createTooltips=function(){this.variationsTooltip=new ch.Tooltip(this.ui.button,{content:this.text.variationsTooltip,side:"top",offsetY:-5,addClass:"validation-tooltip"})},e.prototype.toggleVariationsTooltip=function(){this.variationsComplete?(this.ui.button.style.cursor="",this.variationsTooltip.disable()):(this.ui.button.style.cursor="not-allowed",this.variationsTooltip.enable())},e.prototype.changeQuantityStatus=function(t){this.validQuantity=t.validates},e.prototype.shouldShowTooltips=function(){return!this.isMobile()},e.prototype.bindEvents=function(){var t=this;meli.on("quantity:change",this.changeQuantityStatus.bind(this)),meli.on("quantity:autochange",this.changeQuantityStatus.bind(this)),this.withVariations&&(meli.on("variations:complete",function(i){t.variationsComplete=i.complete,t.shouldShowTooltips()&&t.toggleVariationsTooltip()}),meli.on("variations:changeImage",function(i){i&&i.variationId&&(t.image=t.imageForVariations[i.variationId])})),meli.on("cart:added",this.handleAdded.bind(this)),meli.on("cart:error",this.handleError.bind(this)),tiny.on(this.ui.button,this.isTablet()?"touchstart":"click",this.validateData.bind(this))},e.prototype.validateData=function(t){this.validQuantity&&(this.withVariations&&!this.variationsComplete?(t.preventDefault(),meli.emit("variations:validate")):(this.shouldEmitAddEvent&&this.isMobile()&&t.preventDefault(),this.addItem())),this.trackAction()},e.prototype.addItem=function(){var t={itemId:this.itemId,quantity:this.quantity?this.quantity:this.ui.quantity?this.ui.quantity.value:1,title:this.title,image:this.image},i=null!=this.item_data,a=i?{currency_id:this.item_data.currency_id,item:{id:this.item_data.id,category_id:this.item_data.category_id},quantity:t.quantity,unit_price:this.item_data.unit_price}:{item:{id:this.itemId},quantity:t.quantity};this.ui.variations&&this.withVariations&&(t.variationId=this.ui.variations.value),this.GALabel&&(""==this.congratsExperimentValue?meli_ga("send","event","CART","ADD_TO_CART",this.GALabel):meli_ga("send","event","CART","ADD_TO_CART",this.GALabel,0,{dimension28:this.congratsExperimentValue})),melidata&&this.meliData&&this.meliData.a2c&&(this.meliData.a2c.data.items=[a],"/recommendations/add_to_cart"===this.meliData.a2c.path&&(this.meliData.a2c.data.context=void 0,this.meliData.a2c.data.direct=!1),melidata("cleanAndSend","event",this.meliData.a2c)),this.shouldEmitAddEvent&&(this.showLoading(),meli.emit("cart:add",{token:this.token,item:t,context:"recommendations"})),this.HotjarKey&&"undefined"!=typeof hj&&(hj("trigger",this.HotjarKey),hj("tagRecording",[this.HotjarKey]))},e.prototype.trackAction=function(){melidata&&this.meliData&&this.meliData.action&&(this.withVariations&&(this.meliData.action.data.is_valid_variation=this.variationsComplete),melidata("cleanAndSend","event",this.meliData.action))},e.prototype.handleAdded=function(t){this.itemId===t.itemId&&(melidata&&this.meliData&&this.meliData.a2c&&"/recommendations/add_to_cart"===this.meliData.a2c.path&&melidata("cleanAndSend","event",this.meliData.a2c),this.hideLoading())},e.prototype.handleError=function(t){t&&this.itemId===t.item.itemId&&(melidata&&this.meliData&&this.meliData.a2c&&melidata("send","event",{path:"/vip/add_to_cart_error",data:this.meliData.a2c.data}),this.GALabel&&meli_ga("send","event","CART","ADD_TO_CART_ERROR",this.GALabel),this.hideLoading())},e.prototype.showLoading=function(){tiny.addClass(this.ui.button,"ui-button--is-loading"),this.ui.button.disabled=!0},e.prototype.hideLoading=function(){tiny.removeClass(this.ui.button,"ui-button--is-loading"),this.ui.button.disabled=!1},e.prototype.isTablet=function(){return"tablet"===this.environment},e.prototype.isMobile=function(){return"mobile"===this.environment},a.CartButton=e}(window,document,Meli.prototype);
//# sourceMappingURL=../js/cart-button-17ea833d80.js.map